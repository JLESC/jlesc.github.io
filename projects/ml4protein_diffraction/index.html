<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>JLESC &mdash; Machine Learning-driven Predictive Analysis of Protein Diffraction Data</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The Joint Laboratory for Extreme Scale Computing includes researchers from the French National Institute for Research in Computer Science and Control (INRIA), the University of Illinois at Urbana-Champaign’s Center for Extreme-Scale Computation, the National Center for Supercomputing Applications, Argonne National Laboratory, Barcelona Supercomputing Center, Julich Supercomputing Center and Riken/AICS. The Joint Lab is part of Parallel@Illinois.
">
  <link rel="canonical" href="https://jlesc.github.io/projects/ml4protein_diffraction/">

  <link type="application/atom+xml" rel="alternate" href="https://jlesc.github.io/feed.xml" title="" />
  <link type="text/css" rel="stylesheet" href="/assets/main-1121dc6ec5d1807973ca79a9ef9ac00b1a6150a25e54d3549d42c6d793195499.css">    
</head>

  <body>
    <header>
  <noscript>
    <div class="container-fluid">
      <div class="card card-block card-danger row">
        <p class="card-text text-sm-center">
          You have Javascript disabled. This website might not work as intended and will look not as good as it can.
          <br />
          Please activate Javascript for this website. We are not loading content from other domains.
        </p>
      </div>
    </div>
  </noscript>
  <nav>
    <div class="navbar navbar-fixed-top navbar-dark bg-inverse" role="navigation">
      <div class="container">
        <button class="navbar-toggler hidden-md-up pull-right" type="button" data-toggle="collapse" data-target="#CollapsingNavbar">
          <i class="fa fa-bars fa-fw"></i>
        </button>

        <a class="navbar-brand" href="/">JLESC</a>

        <div class="collapse navbar-toggleable-sm" id="CollapsingNavbar">
          <ul class="nav navbar-nav">
            <li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">About</a>
  <div class="dropdown-menu">
    <a href="/about/" class="dropdown-item">JLESC</a>
    <a href="/about/partners/" class="dropdown-item">Partners</a>
    <a href="/about/people/" class="dropdown-item">People</a>
    <a href="/about/grants/" class="dropdown-item">Grants</a>
  </div>
</li>

            <li class="nav-item">
              <a href="/news/" class="nav-link">News</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/events/">Events</a>
            </li>
            <li class="nav-item dropdown active">
  <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Research</a>
  <div class="dropdown-menu">
    <a href="/research/collaboration/" class="dropdown-item">On Collaboration</a>
    <a href="/projects/" class="dropdown-item active">Projects</a>
    <!-- <a href="/software/" class="dropdown-item">Software</a> -->
    <!-- <a href="/research/visits/" class="dropdown-item">Visits</a> -->
  </div>
</li>

            <li class="nav-item">
              <a class="nav-link" href="/references/">References</a>
            </li>
          </ul>

          <ul class="nav navbar-nav pull-right">
            <li class="nav-item">
              <a class="nav-link"
                 href="https://github.com/JLESC/jlesc.github.io/wiki"
                 target="_blank"
                 title="How to contribute"
                 data-toggle="tooltip"
                 data-placement="left">
                <i class="fa fa-fw fa-book"></i>
                How To
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
</header>

    <main>
      <div class="container">
        <div class="post post-project">
  <article class="post-content">
    <div class="row">
      <header class="col-sm-12 post-header">
        <h1 class="pull-left">Machine Learning-driven Predictive Analysis of Protein Diffraction Data</h1>
      </header>
    </div>
    <div class="row">
      <aside class="col-lg-5 col-sm-12 pull-lg-right collapse in" id="meta-aside">
        <section class="group-meta card">
  <div class="card-header">
    Project Profile
  </div>
  
  <ul class="list-group list-group-flush">
    <li class="list-group-item row">
      <label class="col-sm-4">Topics</label>
      <div class="col-sm-8">
        
          <span class="clearfix">
            <span class="topic topic-title">Apps & Mini-Apps</span>
          </span>
        
      </div>
    </li>
    
      <li class="list-group-item row">
        <label class="col-sm-4">Keywords</label>
        <div class="col-sm-8">
          
            <span class="clearfix">machine learning, protein folding</span>
          
        </div>
      </li>
    
    
    
      <li class="list-group-item row">
        <label class="col-sm-4">Members</label>
        <div class="col-sm-8">
          
            <span class="clearfix">
              <span class="person given-name">Michela</span> <span class="person sur-name">Taufer</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
              <span class="pull-right">
                <a title="Project Head" data-toggle="tooltip"><i class="fa fa-graduation-cap fa-fw"></i></a>
              </span>
            </span>
          
          
            <span class="clearfix">
              <span class="person given-name">Florence</span> <span class="person sur-name">Tama</span> (<abbr title="RIKEN Center for Computational Science" class="initialism" data-toggle="tooltip">R-CCS</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Piotr</span> <span class="person sur-name">Luszczek</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Osamu</span> <span class="person sur-name">Miyashita</span> (<abbr title="RIKEN Center for Computational Science" class="initialism" data-toggle="tooltip">R-CCS</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Paula</span> <span class="person sur-name">Olaya Garcia</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Silvina</span> <span class="person sur-name">Caino-Lores</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Georgia</span> <span class="person sur-name">Channing</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
            </span>
          
            <span class="clearfix">
              <span class="person given-name">Ria</span> <span class="person sur-name">Patel</span> (<abbr title="University of Tennessee" class="initialism" data-toggle="tooltip">UTK</abbr>)
            </span>
          
        </div>
      </li>
    
    
    <li class="list-group-item row">
      <label class="col-sm-4">Status</label>
      <div class="col-sm-8">
        <span class="project-status project-status-running">running</span>
      </div>
    </li>
    
  </ul>
</section>
        <section class="card" id="toc">
          <div class="card-header">
            Table of Contents
          </div>
          <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#research-topic-and-goals">Research topic and goals</a></li>
<li class="toc-entry toc-h2"><a href="#results-for-20202021">Results for 2020/2021</a></li>
<li class="toc-entry toc-h2"><a href="#results-20212022">Results 2021/2022</a></li>
<li class="toc-entry toc-h2"><a href="#results-20222023">Results 2022/2023</a></li>
<li class="toc-entry toc-h2"><a href="#visits-and-meetings">Visits and meetings</a></li>
<li class="toc-entry toc-h2"><a href="#impact-and-publications">Impact and publications</a></li>
<li class="toc-entry toc-h2"><a href="#future-plans">Future plans</a></li>
<li class="toc-entry toc-h2"><a href="#references">References</a></li>
</ul>
        </section>
      </aside>
      <div class="col-lg-7 col-sm-12 pull-lg-left content" id="main-content">
        
        <h2 id="research-topic-and-goals">
<a id="research-topic-and-goals" class="anchor" href="#research-topic-and-goals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Research topic and goals</h2>

<p>A protein’s structure determines its function. Different proteins have different structures; proteins in the same family share similar substructures and may share similar functions. Additionally, one protein may exhibit several structures (or conformations). Identifying different proteins and differentiating between their different conformations is a task that could help solve many complex problems, such as determining the cause of diseases and designing drugs. X-ray Free Electron Laser (XFEL) beams are used to create diffraction patterns (images) that can reveal protein structure (and function). The translation between diffraction patterns in the XFEL images and protein structures is non-trivial.</p>

<p>Three features are embedded in an image and can be captured by ML methods: the orientations of a protein conformation, the conformations of a folded protein, and the different conformations of different proteins. This collaboration between UTK and RIKEN aims to develop an ML-driven workflow integrating a suite of ML methods (from simple k-nearest neighbors and random forest to more complex neural networks) to capture orientations, conformations, and types of proteins from XFEL images. Our ML-driven workflow will build on top of open-source software and open-access datasets. The workflow will be packaged into a tool that will allow us to study and understand the impact of different ML methods and numerical precisions on prediction accuracy, power consumption, and performance for synthetic protein datasets (from simulations) and real XFEL images, as our tool is validated towards noisy, simulated datasets. The collaborators will use the tool at RIKEN for protein discovery.</p>

<h2 id="results-for-20202021">
<a id="results-for-20202021" class="anchor" href="#results-for-20202021" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results for 2020/2021</h2>
<p>In Year 1, we presented XPSI (XFEL-based Protein Structure Identifier) that is a framework relying on ML methods (e.g., autoencoder and kNN) to capture critical information from X-Ray images. The information allows the identification of properties, such as spatial orientation, protein conformation, and different protein types from the diffraction patterns.</p>

<p>Our framework processes diffraction images (or patterns) through an autoencoder that captures critical information and produces a tensor representation of each image. The autoencoder consists of an encoder and a decoder. The encoder has three convolutional filters and downsampling layers, and the decoder has the reverse structure of the encoder. The framework uses the new latent space to train and validate traditional ML models such as k-nearest neighbors (kNN). We use a kNN-angle regressor to predict the orientation and two kNN-classifiers to predict different protein conformations and types.</p>

<p>We explored increasingly complex protein diffraction imaging datasets: four imaging resolutions and two protein types (i.e., EF2 and ribosome) with 4 and 2 conformations, respectively. Each conformation has the spatial orientation represented by the set of the three Euler angles.</p>

<p>We quantified the classification accuracy and performance of XPSI. We observed that as we increased the resolution of the images, we obtained an overall orientation prediction error below 10 degrees for the three angles; a conformation accuracy prediction of 93% for the four EF2’s conformations 1n0u, 1n0vc, 9a, and bc; and an accuracy of 100% when differentiating between the  EF2 and ribosome.</p>

<h2 id="results-20212022">
<a id="results-20212022" class="anchor" href="#results-20212022" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results 2021/2022</h2>

<p>In Year 2, we added the prediction of the final property required to identify a protein structure which is the protein type. Moreover, we designed a solution to overcome symmetry challenges observed when predicting the third rotational angle (in Year 1). Our solution changes the range of the third angle from 0 to 360 degrees to 0 to 180 degrees without affecting the science behind it. Our framework can now accurately identify the predictions, including the three orientation angles, the different conformations, and the protein type. To validate the accuracy, we tested XPSI on a dataset of images from two different proteins (i.e., EF2 and ribosome) with two conformations each (i.e., 1n0u and 1n0vc for EF2 and 9a and bc for ribosome), and two imaging resolutions (high and low). For the high image resolution, we obtained an orientation prediction error of up to 10 degrees, a difference in the predicted third angle of up to 5 degrees, a conformation accuracy prediction of 92%, and a 100% of protein type accuracy prediction. We also released a Jupyter Notebook for the shareability and portability of our framework.</p>

<p>In Year 3, we will test the framework with a more diverse dataset (i.e., three or more protein types with two or more conformations each). We will compare our framework with a traditional XFEL slice matching approach used for 3D reconstruction.</p>

<h2 id="results-20222023">
<a id="results-20222023" class="anchor" href="#results-20222023" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results 2022/2023</h2>

<p>In Year 3, we demonstrated the capabilities of our XPSI (X-ray Free Electron Laser-based Protein Structure Identifier) framework by quantifying its accuracy when using challenging datasets and combinations of protein’s structural properties. We observed these three key findings:</p>
<ol>
  <li>Our framework predicts orientation despite symmetry in the diffraction patterns for the EF2 protein with an error degree and Psi difference within 10 degrees for the 95th percentile of the testing dataset for high beam intensity.</li>
  <li>The framework predicts confirmations with an accuracy of 97%, even when the structural shapes of the conformations are nearly indistinguishable.</li>
  <li>Our framework correctly differentiates (with 100% accuracy ) between two protein types (EF2 and ribosome) in a broad and realistic set of diffraction patterns with multiple conformations and orientations.</li>
</ol>

<p>We delivered a Jupyter Notebook implementing the XPSI framework, which can be found at: https://github.com/TauferLab/XPSI.</p>

<p>Neural networks (NNs) are gaining momentum in high-throughput scientific workflows; they inspired a new direction for this project. We expanded the framework to use a multi-objective Neural Architecture Search (NAS), NSGA-Net, to search for highly accurate NNs capable of predicting protein structural properties while optimizing resource efficiency (i.e., minimizing FLoating-point Operations Per Second or FLOPS). We define a domain-agnostic methodology to generate NNs with the support of NSGA-Net, select promising NNs that balance accuracy and FLOPS usage, and refine a subset of NNs to curate networks suitable for efficient data analysis. We apply this methodology to our protein diffraction use case. Preliminary results show NNs that efficiently classify the conformation of proteins with a final accuracy of 97.7% or higher and using only 187 FLOPS.</p>

<p>In Year 4, we will work on the following:</p>
<ul>
  <li>We will complete the prediction of the entire property set (i.e., orientation, conformation, and protein type) using near-optimal NNs.</li>
  <li>We will make the advanced framework available through open-source software, with Jupyter notebook tutorials to increase access to our technology.</li>
  <li>We will compare our framework with a traditional XFEL slice matching approach used for 3D reconstruction and follow the premises of orientation prediction through multiple and time-consuming iterations.</li>
</ul>

<h2 id="visits-and-meetings">
<a id="visits-and-meetings" class="anchor" href="#visits-and-meetings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visits and meetings</h2>
<p>Taufer will meet Tama and Miyashita during her visit at RIKEN on Deb 6-9 for the DOE/MEXT and R-CCS meeting.</p>

<h2 id="impact-and-publications">
<a id="impact-and-publications" class="anchor" href="#impact-and-publications" aria-hidden="true"><span class="octicon octicon-link"></span></a>Impact and publications</h2>

<ul>
  <li>A paper at IEEE e-Science 2022 <a href="#OlayaEtAl2022">(Olaya et al. 2022)</a>
</li>
  <li>A short paper at IEEE e-Science 2022 <a href="#PatelEtAl2022">(Patel et al. 2022)</a>
</li>
  <li>Talk: 14th Joint Laboratory for Extreme Scale Computing (JLESC) Workshop, 2022. Project Talk: Machine Learning-driven Predictive Analysis of Protein Diffraction Data.</li>
  <li>Talk: 14th Joint Laboratory for Extreme Scale Computing (JLESC) Workshop, 2022. Short Talk: Methods, Workflows, and Data Commons for Reducing Training Costs in Neural Architecture Search on High-Performance Computing Platforms</li>
  <li>Talk: 13th Joint Laboratory for Extreme Scale Computing (JLESC) Workshop, 2021. Short Talk: XPSI: XFEL-based Protein Structure Identifier.</li>
  <li>Talk: 12th Joint Laboratory for Extreme Scale Computing (JLESC) Workshop, 2021. Short Talk: XPSI: XFEL-based Protein Structure Identifier.</li>
  <li>Poster: Paula Olaya, Michael R. Wyatt II, Silvina Caino-Lores, Florence Tama, Osamu Miyashita, Piotr Luszczek, and Michela Taufer, “XPSI: X-ray Free Electron Laser based Protein Structure Identifier,” ACM/IEEE International Conference for High Performance Computing, Networking, Storage and Analysis, Research Poster, Atlanta, GA, 2020.</li>
  <li>Talk: 11th Joint Laboratory for Extreme Scale Computing (JLESC) Workshop, 2020. Short Talk: XPSI: XFEL-based Protein Structure Identifier.</li>
</ul>

<ol class="bibliography">
<li>
<div class="bibtex-entry-container">
  <div>
    <div class="col-md-3 col-sm-12 bibtex-ref-meta hidden">
      <div class="row">
        <div class="col-md-12 ref-label tag tag-default">
          OlayaEtAl2022
        </div>
      </div>
      <div class="row">
        <button class="btn btn-sm btn-secondary col-xs-6" data-toggle="collapse" data-target="#collapseOlayaEtAl2022Bibtex" aria-expanded="false" aria-controls="collapseOlayaEtAl2022Bibtex">
          BibTeX
        </button>
        <button class="btn btn-sm btn-secondary-outline col-xs-6" disabled data-toggle="collapse" data-target="#collapseOlayaEtAl2022Abstract" aria-expanded="false" aria-controls="collapseOlayaEtAl2022Abstract">
          Abstract
        </button>
      </div>
    </div>

    <div class="bibtex-ref-entry">
      <span id="OlayaEtAl2022">Olaya, Paula, Silvina Caíno-Lores, Vanessa Lama, Ria Patel, Ariel Keller Rorabaugh, Osamu Miyashita, Florence Tama, and Michela Taufer. 2022. “Identifying Structural Properties of Proteins from X-Ray Free Electron Laser Diffraction Patterns.” In <i>2022 IEEE 18th International Conference on e-Science (e-Science)</i>, 21–31. doi:10.1109/eScience55777.2022.00017.</span>
    </div>
  </div>
  <div class="collapse" id="collapseOlayaEtAl2022Bibtex">
    <div class="row bibtex-ref-raw">
      <div class="col-sm-10 offset-sm-1">
        <pre><code>@inproceedings{OlayaEtAl2022,
  author = {Olaya, Paula and Caíno-Lores, Silvina and Lama, Vanessa and Patel, Ria and Rorabaugh, Ariel Keller and Miyashita, Osamu and Tama, Florence and Taufer, Michela},
  booktitle = {2022 IEEE 18th International Conference on e-Science (e-Science)},
  title = {Identifying Structural Properties of Proteins from X-ray Free Electron Laser Diffraction Patterns},
  year = {2022},
  volume = {},
  number = {},
  pages = {21-31},
  doi = {10.1109/eScience55777.2022.00017}
}
</code></pre>
      </div>
    </div>
  </div>
  
</div>
</li>
<li>
<div class="bibtex-entry-container">
  <div>
    <div class="col-md-3 col-sm-12 bibtex-ref-meta hidden">
      <div class="row">
        <div class="col-md-12 ref-label tag tag-default">
          PatelEtAl2022
        </div>
      </div>
      <div class="row">
        <button class="btn btn-sm btn-secondary col-xs-6" data-toggle="collapse" data-target="#collapsePatelEtAl2022Bibtex" aria-expanded="false" aria-controls="collapsePatelEtAl2022Bibtex">
          BibTeX
        </button>
        <button class="btn btn-sm btn-secondary-outline col-xs-6" disabled data-toggle="collapse" data-target="#collapsePatelEtAl2022Abstract" aria-expanded="false" aria-controls="collapsePatelEtAl2022Abstract">
          Abstract
        </button>
      </div>
    </div>

    <div class="bibtex-ref-entry">
      <span id="PatelEtAl2022">Patel, Ria, Ariel Keller Rorabaugh, Paula Olaya, Silvina Caino-Lores, Georgia Channing, Catherine Schuman, Osamu Miyashita, Florence Tama, and Michela Taufer. 2022. “A Methodology to Generate Efficient Neural Networks for Classification of Scientific Datasets.” In <i>2022 IEEE 18th International Conference on e-Science (e-Science)</i>, 389–90. doi:10.1109/eScience55777.2022.00052.</span>
    </div>
  </div>
  <div class="collapse" id="collapsePatelEtAl2022Bibtex">
    <div class="row bibtex-ref-raw">
      <div class="col-sm-10 offset-sm-1">
        <pre><code>@inproceedings{PatelEtAl2022,
  author = {Patel, Ria and Rorabaugh, Ariel Keller and Olaya, Paula and Caino-Lores, Silvina and Channing, Georgia and Schuman, Catherine and Miyashita, Osamu and Tama, Florence and Taufer, Michela},
  booktitle = {2022 IEEE 18th International Conference on e-Science (e-Science)},
  title = {A Methodology to Generate Efficient Neural Networks for Classification of Scientific Datasets},
  year = {2022},
  volume = {},
  number = {},
  pages = {389-390},
  doi = {10.1109/eScience55777.2022.00052}
}
</code></pre>
      </div>
    </div>
  </div>
  
</div>
</li>
</ol>

<h2 id="future-plans">
<a id="future-plans" class="anchor" href="#future-plans" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future plans</h2>

<p>Looking ahead, we are working on understanding the qualities of successful neural architectures and visualizing them in an interactive software package. Currently, we are testing a NN-based solution with a suite of popular neural architecture search workflows and assessing their suitability for predicting protein structural properties. In Year 4, we will package the findings into our software framework and an associated Jupyter notebook to allow for the widespread use of our NNs in XFEL image analysis. Our package will integrate a multi-type output layer that predicts regression and classification results from a single run rather than two distinct runs. By the end of 2023, we will have the results of tests of our prediction engine with at least three different NASes on our XFEL image dataset. The results of all these tests will be available in a NN data commons.</p>

<h2 id="references">
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h2>
<p><a href="https://github.com/TauferLab/XPSI">Github Repository</a></p>

      </div>
    </div>
  </article>
  
</div>

      </div>
    </main>
    <footer id="site-footer">
  <div class="navbar navbar-full navbar-light">
    <div class="container">
      <div class="row small">
        <div class="col-xs-6 col-sm-3">
          <ul class="nav navbar-nav navbar-left">
            <li class="nav-item">
              <a class="nav-link" href="/about/imprint/">
                <i class="fa fa-copyright fa-fw"></i><span class="hidden-md-down">Imprint</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://help.github.com/articles/github-privacy-statement/">
                <i class="fa fa-github fa-fw"></i><span class="hidden-md-down">Privacy</span></a>
            </li>
          </ul>
        </div>
        <div class="col-sm-6 hidden-xs-down">
          <div class="nav navbar-nav text-xs-center">
            <span class="credit">
              Powered by
              <a class="nav-link" href="https://jekyllrb.com">Jekyll</a> and
              <a class="nav-link" href="https://getbootstrap.com">Twitter Bootstrap</a>
            </span>
          </div>
        </div>
        <div class="col-xs-6 col-sm-3">
          <ul class="nav navbar-nav navbar-right">
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/JLESC/jlesc.github.io">
                <i class="fa fa-github fa-fw"></i><span class="hidden-md-down">Sources</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/JLESC/jlesc.github.io/issues">
                <i class="fa fa-bug fa-fw"></i><span class="hidden-md-down">Found a typo?</span></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

    <!-- Latest compiled and minified JavaScript -->
<script type="text/javascript" src="/assets/main-f379c72bc0f1ca6c99205f5005786103a2b61210898a52b504597ea1e2e75917.js"></script>

<!--  -->

  </body>
</html>
